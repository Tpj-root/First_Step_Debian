
**BASIC**




**Exploit Example: Overwriting the Return Address**




Filename: exploit_me.c

```c
#include <stdio.h>
#include <string.h>

void secret_function() {
    printf("üî• You hacked the program! üî•\n");
}

int main() {
    char buffer[10];  // Small buffer
    
    printf("Enter a string: ");
    gets(buffer);  // ‚ùå Vulnerable function (no size check)
    
    printf("You entered: %s\n", buffer);
    return 0;
}

```


```
gcc -fno-stack-protector -z execstack exploit_me.c -o exploit_me
gdb ./exploit_me
```


**Inside GDB:**


```
(gdb) disassemble secret_function


```




gdb ./exploit_me


break main
run
info functions
p &secret_function


3. Check memory mappings

(gdb) info proc mappings



(base) cnc@debian:~/Desktop/BUILD_FILES/c$ nm ./exploit_me | grep secret_function
0000000000001159 T secret_function
(base) cnc@debian:~/Desktop/BUILD_FILES/c$ 




(base) cnc@debian:~/Desktop/BUILD_FILES/c$ printf "0x%X\n" $((0x555555554000 + 0x1159))
0x555555555159
(base) cnc@debian:~/Desktop/BUILD_FILES/c$ 






(gdb) info registers rip
rip            0x7ffff7df3200      0x7ffff7df3200 <__libc_start_call_main+48>
Missing register name
(gdb) 






from pwn import *
print(cyclic_find(0x7ffff7df3200, n=8))  # Use the actual RIP value from GDB




>>> print(cyclic_find(0x6161616161616169, n=8))  # 64-bit binary (8-byte)
64
>>> 




(No debugging symbols found in ./exploit_me)
(gdb) info functions
All defined functions:

Non-debugging symbols:
0x0000000000001000  _init
0x0000000000001030  puts@plt
0x0000000000001040  printf@plt
0x0000000000001050  gets@plt
0x0000000000001060  exit@plt
0x0000000000001070  __cxa_finalize@plt
0x0000000000001080  _start
0x00000000000010b0  deregister_tm_clones
0x00000000000010e0  register_tm_clones
0x0000000000001120  __do_global_dtors_aux
0x0000000000001160  frame_dummy
0x0000000000001169  secret_function
0x0000000000001186  main
0x00000000000011d8  _fini


(gdb) disas secret_function
Dump of assembler code for function secret_function:
   0x0000000000001169 <+0>: push   %rbp
   0x000000000000116a <+1>: mov    %rsp,%rbp
   0x000000000000116d <+4>: lea    0xe94(%rip),%rax        # 0x2008
   0x0000000000001174 <+11>:    mov    %rax,%rdi
   0x0000000000001177 <+14>:    call   0x1030 <puts@plt>
   0x000000000000117c <+19>:    mov    $0x0,%edi
   0x0000000000001181 <+24>:    call   0x1060 <exit@plt>
End of assembler dump.
